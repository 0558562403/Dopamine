//
//  CBindings.h
//  kexploitd
//
//  Created by Linus Henze.
//  Copyright Â© 2022 Pinauten GmbH. All rights reserved.
//

#ifndef CBindings_h
#define CBindings_h

#include <spawn.h>
#include <fcntl.h>
#import <Foundation/Foundation.h>

#include "posix_spawn.h"
#include "th_state.h"

extern int loadSignature(NSString* filePath);
extern uint64_t getPCIMemorySize(void);
extern void getStatus(uint64_t *pplStatus, uint64_t *pacStatus, pid_t *pid);
extern void sendPPLHandoffRequest(uint64_t magicPage);
extern uint64_t sendPACHandoffRequest(uint64_t kernelAllocation);
extern void sendPACFinalizeHandoffRequest(void);
extern void sendRebuildTrustCacheRequest(void);

#endif /* CBindings_h */
